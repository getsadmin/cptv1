<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Commerical Tracker</title>
    <link rel="stylesheet" href="style1.css" />
    <link rel="stylesheet" href="style.css">
    <!-- Boxicons CSS -->
    <link flex href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
    <script src="script1.js" defer></script>
  </head>
  <body>
    <nav class="sidebar locked">
      <div class="logo_items flex">
        <span class="nav_image">
          <img src="images/white_logo.png" alt="logo_img" />
        </span>
        <span class="logo_name">GalaxiETS</span>
        <i class="bx bx-lock-alt" id="lock-icon" title="Unlock Sidebar"></i>
        <i class="bx bx-x" id="sidebar-close"></i>
      </div>

      <div class="menu_container">
        <div class="menu_items">
          <ul class="menu_item">
            <div class="menu_title flex">
              <span class="title">Main</span>
              <span class="line"></span>
            </div>
            <li class="item">
              <a href="dashboard.html" class="link flex">
                <i class="bx bx-home-alt"></i>
                <span>DashBoard</span>
              </a>
            </li>
          
          </ul>

          <ul class="menu_item">
            <div class="menu_title flex">
              <span class="title">Storing</span>
              <span class="line"></span>
            </div>
            <li class="item">
              <a href="companydata.html" class="link flex"> 
               
                <i class='bx bx-notepad'></i>
                <span>Company Data</span>
              </a>
            </li>
            <li class="item">
              <a href="customerdata.html" class="link flex">
                <i class="bx bx-folder"></i>
                
                <span>Customer Data</span>
              </a>
            </li>
            <li class="item">
              <a href="projectdata.html" class="link flex">
                <i class='bx bxs-message-square-detail'></i>
              
                <span>Project Data</span>
              </a>
            </li>
          </ul>

          <ul class="menu_item">
            <div class="menu_title flex">
              <span class="title">Generator</span>
              <span class="line"></span>
            </div>
            <li class="item">
              <a href="quotation.html" class="link flex">
                <i class='bx bxs-notepad'></i>
                <span>Quotation</span>
              </a>
            </li>
            <li class="item">
              <a href="pogenerator.html" class="link flex">
                <i class="bx bx-grid-alt"></i>
             
                <span>PO</span>
              </a>
            </li>
            <li class="item">
              <a href="invoice.html" class="link flex">
                <i class='bx bxs-receipt' ></i>
                <span>Invoice</span>
              </a>
            </li>
          </ul>

          <ul class="menu_item">
            <div class="menu_title flex">
              <span class="title">Upload</span>
              <span class="line"></span>
            </div>
            <li class="item">
              <a href="po.html" class="link flex">
                <i class="bx bx-cloud-upload"></i>
                <span>PO</span>
              </a>
            </li>
          </ul>
          <ul class="menu_item">
            <div class="menu_title flex">
              <span class="title">Closure</span>
              <span class="line"></span>
            </div>
            <li class="item">
              <a href="payments.html" class="link flex">
                <i class='bx bx-credit-card'></i>
                <span>Payments</span>
              </a>
            </li>
            <li class="item">
              <a href="trackers.html" class="link flex">
                <i class='bx bx-line-chart'></i>
                <span>Tracker</span>
              </a>
            </li>
            <li class="item">
              <a href="close.html" class="link flex">
                <i class='bx bx-x'></i>
                <span>Close</span>
              </a>
            </li>
          </ul>
        </div>
        <div class="sidebar_profile">
          <div class="nav_image">
            <img src="images/adminprofile.jpg" alt="logo_img"/>
            <span class="name">Admin</span>
          </div>
            <div class="out">
              <a href="signin.html" class="log-out">
                <i class='bx bx-log-out'></i>
   </a> </div>
          </div>  
        </div>
        
      </div>
    </nav>

  <main>
    <div class="form-container">
        <h1>PO Details</h1>
        <form action="/poData" method="post" class="form" enctype="multipart/form-data" >

            <div class="container1">
              <div class="column">
                <div class="input-box">
                    <label>PO Number</label>
                    <input type="text" id="poNumber" name="poNumber" placeholder="Enter PO Number" required />
                </div>
                <div class="input-box">
                    <label>PO Date as per PO</label>
                    <input type="date" id="poDate" name="poDate" placeholder="Enter date" required />
                </div>
                </div>
                <div class="column">
                <div class="input-box">
                    <label>PO HSN Code</label>
                    <input type="text" id="poHSNCode" name="poHSNCode" placeholder="Enter Code" required />
                </div>
           </div>
            <br>
            <div class="column">
            <header>Upload PO</header>
            <input type="file" name="imageUpload" id="imageUpload">
            <button class="preview-button" onclick="previewPDF()">Preview</button>
          </div>
      </div>
            <br><br>
            <div>
              <button class="button back-button" style="vertical-align:middle" onclick="goBack()"><span>Back</span></button>
                <button type="button" class="button delete-button" style="vertical-align:middle"><span>Delete</span></button>
               
                <button type="submit" class="button save-button" style="vertical-align:middle"><span>Save</span></button>
            </div>
        </form>
    </div>

  </section>
    
   <p class="copyright">
    &copy; 2024 - <span>GALAXIETS</span> All Rights Reserved.
    </p>
    </main>

<script src="script.js"></script>
<script>

  document.addEventListener("DOMContentLoaded", function() {
    // Get the po no from the input field
    var PO = document.getElementById('poNumber').value;
    
    // Store the po ID in localStorage
    localStorage.setItem('PO', PO);
      });

  // Function to fetch PDF files from backend and generate links
  async function fetchAndDisplayPDFs() {
    try {
      // Fetch PDF file names from backend
      const response = await fetch('/pdf/files');
      const pdfFiles = await response.json();

      // Container to display PDF links
      const pdfLinksContainer = document.getElementById('pdfLinks');

      // Generate links for each PDF file
      pdfFiles.forEach(pdfFile => {
        const link = document.createElement('a');
        link.href = `/pdf/${pdfFile.filename}`;
        link.textContent = pdfFile.filename;
        link.target = '_blank'; // Open in new tab
        pdfLinksContainer.appendChild(link);
        pdfLinksContainer.appendChild(document.createElement('br')); // Add line break
      });
    } catch (error) {
      console.error('Error fetching PDF files:', error);
    }
  }

  // Call the function to fetch and display PDFs when the page loads
  window.onload = fetchAndDisplayPDFs;

  function previewPDF() {
  // Get the uploaded file
  const fileInput = document.getElementById('imageUpload');
  const file = fileInput.files[0];

  if (file) {
    // Create a URL for the uploaded file
    const fileURL = URL.createObjectURL(file);
    
    // Open the file URL in a new tab for previewing
    window.open(fileURL, '_blank');
  } else {
    // Handle case when no file is selected
    alert('Please select a PDF file for previewing.');
  }
}

</script>
</body>

</html>
